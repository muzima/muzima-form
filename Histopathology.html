<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/muzima.css" rel="stylesheet">
    <link href="css/ui-darkness/jquery-ui-1.10.4.custom.min.css" rel="stylesheet">
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery-ui-1.10.4.custom.min.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/additional-methods.min.js"></script>
    <script src="js/muzima.js"></script>
    <title>Histopathology Form v 0.01</title>
</head>
<body class="col-md-10 col-md-offset-1">
<div id="result"></div>
<form class="relevant-female" id="histopathology_form" name="histopathology_form">
    <h2 class="text-center">Histopathology Form v 0.01</h2>

    <div class="section">
        <h3>Patient Demographics</h3>
        <div class="form-group">
            <input class="form-control" id="patient.uuid" hidden="hidden"
                   name="patient.uuid" type="text" readonly="readonly">
        </div>
        <div class="form-group">
            <label for="patient.given_name">Given Name:</label>
            <input class="form-control" id="patient.given_name" name="patient.given_name" type="text" readonly="readonly">
        </div>
        <div class="form-group">
            <label for="patient.family_name">Family Name:</label>
            <input class="form-control" id="patient.family_name" name="patient.family_name" type="text" readonly="readonly">
        </div>
        <div class="form-group">
            <label for="patient.middle_name">Middle Name:</label>
            <input class="form-control" id="patient.middle_name" name="patient.middle_name" type="text" readonly="readonly">
        </div>
        <div class="form-group">
            <label for="patient.medical_record_number">AMRS ID Number</label>
            <input class="form-control checkDigit" id="patient.medical_record_number"
                   name="patient.medical_record_number" type="text" readonly="readonly">
        </div>
        <div class="form-group">
            <label for="patient.sex">Gender:</label>
            <select class="form-control" id="patient.sex" name="patient.sex" readonly="readonly">
                <option value="">...</option>
                <option value="M">Male</option>
                <option value="F">Female</option>
            </select>
        </div>
        <div class="form-group">
            <label for="patient.birthdate">Date Of Birth</label>
            <input class="form-control" id="patient.birthdate"
                   name="patient.birthdate" type="text" readonly="readonly">
        </div>
    </div>
    <div class="section">
        <h3>Encounter Details</h3>
        <div class="form-group">
            <label for="encounter.location_id">Screening Site:<span class="required">*</span></label>
            <select class="form-control" name="encounter.location_id" id="encounter.location_id" required="required">
                <option value="">...</option>
                <option value="84">AMPATH-MTRH</option>
                <option value="19">Busia</option>
                <option value="7">Chulaimbo</option>
                <option value="17">Iten</option>
                <option value="11">Kitale</option>
                <option value="2">Mosoriot Health Centre</option>
                <option value="20">Port Victoria</option>
                <option value="12">Teso District Hospital</option>
                <option value="3">Turbo Health Centre</option>
                <option value="8">Webuye</option>
            </select>
        </div>
        <div class="form-group">
            <label for="encounter.encounter_datetime">Encounter Date:<span class="required">*</span>
            </label>
            <input class="form-control datepicker nonFutureDate" id="encounter.encounter_datetime"
                   name="encounter.encounter_datetime" type="text" readonly="readonly"
                   required="required">
        </div>
        <div class="form-group">
            <input class="form-control" id="encounter.form_uuid" name="encounter.form_uuid" type="hidden"
                   required="required">
        </div>
    </div>
    <div class="section repeat precedure_done_detailed" data-concept="7480^PROCEDURES DONE THIS VISIT, DETAILED^99DCT"
            id="precedure_done_detailed" data-name="precedure_done_detailed">
        <h3>Procedures Done This Visit</h3>

        <div class="form-group">
            <label for="obs.body_part">Body Part Where Specimen Was Collected? <span class="required">*</span></label>
            <select class="form-control" name="obs.body_part" id="obs.body_part" data-concept="8265^BODY PART^99DCT"
                    required="required">
                <option value="">...</option>
                <option value="8279^CERVIX^99DCT">Cervix</option>
                <option value="8280^VAGINA^99DCT">Vagina</option>
                <option value="8281^VULVA^99DCT">Vulva</option>
            </select>
        </div>
        <div class="form-group">
            <label for="obs.procedures_done_this_visit_detailed">How was specimen collected?<span class="required">*</span></label>
            <select class="form-control" name="obs.procedures_done_this_visit_detailed"
                    data-concept="7479^PROCEDURES DONE THIS VISIT^99DCT"
                    id="obs.procedures_done_this_visit_detailed" required="required">
                <option value="">...</option>
                <option value="7147^LOOP ELECTROSURGICAL EXCISION PROCEDURE^99DCT">LEEP</option>
                <option value="6511^EXCISIONAL OR SURGICAL BIOPSY^99DCT">Cervical punch/excisional Biopsy</option>
                <option value="7478^ENDOCERVICAL CURETTAGE ^99DCT">Endocervical curretage (ECC)</option>
            </select>
        </div>
        <div class="form-group ">
            <label for="obs.anatomic_location_description">Provide Location Of Specimen</label>
            <select class="form-control" name="obs.anatomic_location_description"
                    data-concept="8268^ANATOMIC LOCATION DESCRIPTION^99DCT" id="obs.anatomic_location_description"
                    required="required">
                <option value="">...</option>
                <option value="8266^SUPERFICIAL^99DCT">Superficial</option>
                <option value="8267^DEEP^99DCT">Deep</option>
                <option value="5622^OTHER NON-CODED^99DCT">Other non-coded</option>
            </select>
        </div>
        <div class="form-group">
            <label for="obs.clock_face_cervical_biopsy_location">
                Provide location where biopsy for specimen was done: __O'clock</label>
            <input class="form-control" id="obs.clock_face_cervical_biopsy_location"
                   name="obs.clock_face_cervical_biopsy_location"
                   data-concept="7481^CLOCK FACE CERVICAL BIOPSY LOCATION ^99DCT" type="number">
        </div>
        <div class="form-group">
            <label for="obs.pathological_diagnosis_added_cervix">Pathological Diagnosis for Cervical Specimen</label>
            <select class="form-control" data-concept="8278^PATHOLOGICAL DIAGNOSIS ADDED^99DCT"
                    name="obs.pathological_diagnosis_added_cervix"
                    id="obs.pathological_diagnosis_added_cervix" required="required">
                <option>...</option>
                <option value="1115^NORMAL^99DCT">Normal</option>
                <option value="149^CERVICITIS^99DCT">Cervicitis</option>
                <option value="8282^CERVICAL SQUAMOUS METAPLASIA^99DCT">Cervical squamous metaplasia</option>
                <option value="7424^CERVICAL INTRAEPITHELIAL NEOPLASIA GRADE 1^99DCT">
                    Mild cervical intraepithelial neoplasia (CIN 1)
                </option>
                <option value="7425^CERVICAL INTRAEPITHELIAL NEOPLASIA GRADE 2^99DCT">
                    Moderate cervical intraepithelial neoplasia (CIN 2)
                </option>
                <option value="7216^CERVICAL INTRAEPITHELIAL NEOPLASIA GRADE 3^99DCT">
                    Severe cervical intraepithelial neoplasia (CIN 3)
                </option>
                <option value="8275^CERVICAL ADENOCARCINOMA^99DCT">Cervical adenocarcinoma</option>
                <option value="8275^CERVICAL ADENOCARCINOMA^99DCT">Cervical squamous cell carcinoma</option>
                <option value="5622^OTHER NON-CODED^99DCT">Other non-coded</option>
            </select>
        </div>
        <div class="form-group concept">
            <label for="obs.pathological_diagnosis_added_vagina">Pathological Diagnosis for Vaginal Specimen</label>
            <select class="form-control" data-concept="8278^PATHOLOGICAL DIAGNOSIS ADDED^99DCT"
                    name="obs.pathological_diagnosis_added_vagina"
                    id="obs.pathological_diagnosis_added_vagina" required="required">
                <option>...</option>
                <option value="1115^NORMAL^99DCT">Normal</option>
                <option value="7492^VAGINAL INTRAEPITHELIAL NEOPLASIA GRADE 1^99DCT">
                    Mild vaginal intraepithelial neoplasia (VAIN1)
                </option>
                <option value="7491^VAGINAL INTRAEPITHELIAL NEOPLASIA GRADE 2 ^99DCT">
                    Moderate vaginal intraepithelial neoplasia (VAIN 2)
                </option>
                <option value="7435^VAGINAL INTRAEPITHELIAL NEOPLASIA GRADE 3^99DCT">
                    Severe vaginal intraepithelial neoplasia (VAIN 3)
                </option>
                <option value="5622^OTHER NON-CODED^99DCT">Other non-coded</option>
            </select>
        </div>
        <div class="form-group">
            <label for="obs.pathological_diagnosis_added_vulva">Pathological Diagnosis for Vulval Specimen</label>
            <select class="form-control" data-concept="8278^PATHOLOGICAL DIAGNOSIS ADDED^99DCT"
                    name="obs.pathological_diagnosis_added_vulva"
                    id="obs.pathological_diagnosis_added_vulva" required="required">
                <option>...</option>
                <option value="1115^NORMAL^99DCT">Normal</option>
                <option value="7489^CONDYLOMA OR VULVAR INTRAEPITHELIAL NEOPLASIA GRADE 1^99DCT">
                    Condyloma / Mild vulva intraepithelial neoplasia (VIN1)
                </option>
                <option value="7488^VULVAR INTRAEPITHELIAL NEOPLASIA GRADE 2^99DCT">
                    Moderate vulva intraepithelial neoplasia (VIN 2)
                </option>
                <option value="7483^VULVAR INTRAEPITHELIAL NEOPLASIA GRADE 3^99DCT">
                    Severe vulva intraepithelial neoplasia (VIN 3)
                </option>
                <option value="5622^OTHER NON-CODED^99DCT">Other non-coded</option>
            </select>
        </div>
    </div>

    <div class="section">
        <div class="form-group">
            <label for="encounter.provider_id_select">Provider Name:</label>
            <input class="form-control valid-provider-only" id="encounter.provider_id_select" type="text"
                   placeholder="Start typing provider name here ...">
            <input class="form-control" name="encounter.provider_id_select" type="hidden">
        </div>
        <div class="form-group hidden">
            <select id="select_providers">
                <option data-provider = "Daurine Achieng Agumba" value = "3419-9">Daurine Achieng Agumba</option>
                <option data-provider = "Irene Chepkosgei Kurgat" value = "3420-7">Irene Chepkosgei Kurgat</option>
                <option data-provider = "Rose Cheruto Toroitich" value = "3421-5">Rose Cheruto Toroitich</option>
                <option data-provider = "Mary Kipkurui Kimosop" value = "3422-3">Mary Kipkurui Kimosop</option>
                <option data-provider = "Jacqueline Chemom Ndiema" value = "3423-1">Jacqueline Chemom Ndiema</option>
                <option data-provider = "Grace Wanjiru Mwangi" value = "3424-9">Grace Wanjiru Mwangi</option>
                <option data-provider = "Collette Mabia Palapala" value = "3425-6">Collette Mabia Palapala</option>
                <option data-provider = "Dorice Erima Wekesa" value = "3426-4">Dorice Erima Wekesa</option>
                <option data-provider = "Agnes Kagure Boen" value = "120-6">"Agnes Kagure Boen</option>
                <option data-provider = "Linet Kerubo Onyancha" value = "3427-2">Linet Kerubo Onyancha</option>
                <option data-provider = "Delinah Muchai Tanui" value = "1208-8">Delinah Muchai Tanui</option>
                <option data-provider = "Hellen Mushimbi Indumbwe" value = "3321-7">Hellen Mushimbi Indumbwe</option>
                <option data-provider = "Lydia Cherugut Samoei" value = "1525-5">Lydia Cherugut Samoei</option>
                <option data-provider = "Ruth Kalunda Nzili" value = "1529-7">Ruth Kalunda Nzili</option>
                <option data-provider = "Lucy Cheruto Birgen" value = "3428-0">Lucy Cheruto Birgen</option>
                <option data-provider = "Gratiah Nafuna Khaemba" value = "1409-2">Gratiah Nafuna Khaemba</option>
                <option data-provider = "Leonida Chemutai Mengich" value = "1357-3">Leonida Chemutai Mengich</option>
                <option data-provider = "Ann Wangoi Maina" value = "1412-6">Ann Wangoi Maina</option>
                <option data-provider = "Elkanah Omenge Orango" value = "1474-6">Elkanah Omenge Orango</option>
                <option data-provider = "Peter Mukhanadale Istura" value = "1478-7">Peter Mukhanadale Istura</option>
                <option data-provider = "Hillary Mabeya" value = "1476-1">Hillary Mabeya</option>
                <option data-provider = "Astrid Christoffersen Deb" value = "1237-7">Astrid Christoffersen Deb</option>
                <option data-provider = "Philip Kipkirui Tonui" value = "1485-7">Philip Kipkirui Tonui</option>
                <option data-provider = "Ann Jebet Ngelel" value = "3613-7">Ann Jebet Ngelel</option>
                <option data-provider = "Job Wekesa Wamukaya" value = "3614-5">Job Wekesa Wamukaya</option>
                <option data-provider = "Joyce Chepkorir Chessum" value = "3615-2">Joyce Chepkorir Chessum</option>
                <option data-provider = "Monica Chelimo Rotich" value = "3616-0">Monica Chelimo Rotich</option>
                <option data-provider = "Penina Jerotich Biwott" value = "3617-8">Penina Jerotich Biwott</option>
                <option data-provider = "Peter Gachingi Kamau" value = "3618-6">Peter Gachingi Kamau</option>
                <option data-provider = "Phanice Jepkemoi Tomu" value = "3619-4">Phanice Jepkemoi Tomu</option>
                <option data-provider = "Phyllis Jelagat Bartilol" value = "3620-2">Roselyne Yatich</option>
                <option data-provider = "Roselyne Yatich" value = "3621-0">Roselyne Yatich</option>
                <option data-provider = "Ruth Sego" value = "3622-8">Ruth Sego</option>
                <option data-provider = "Yosabia Osebe Monari" value = "3623-6">Yosabia Osebe Monari</option>
                <option data-provider = "Philip Kipkirui Tonui" value = "1485-7">Philip Kipkirui Tonui</option>
            </select>
        </div>

        <div class="form-group show_provider_id_text">
            <label for="encounter.provider_id">Enter provider's system-id:<span class="required">*</span></label>
            <input class="form-control checkDigit" id="encounter.provider_id" name="encounter.provider_id" type="text"
                   placeholder="Or enter the provider system id here ..." required="required">
        </div>
         <div class="form-group">
            <label for="freetext_general">Comments</label>
            <input class="form-control" name="freetext_general" id="freetext_general"
                      data-concept="1915^FREETEXT GENERAL^99DCT"
                      placeholder="Provider notes/comments.">
        </div>
    </div>
</form>

</body>
<script type="text/javascript">

    $(document).ready(function () {

        var dateFormat = "dd-mm-yy";
        var currentDate = $.datepicker.formatDate(dateFormat, new Date());
        var encounterDatetime = $('#encounter\\.encounter_datetime');
        if ($(encounterDatetime).val() == "") {
            $(encounterDatetime).val(currentDate);
        }

        $('#save_draft').click(function () {
            $(this).prop('disabled', true);
            document.saveDraft(this);
            $(this).prop('disabled', false);
        });

        $('#submit_form').click(function () {
            $(this).prop('disabled', true);
            document.submit();
            $(this).prop('disabled', false);
        });

        var locationName = [
        {"val": "7", "label": "Chulaimbo"},
        {"val": "3", "label": "Turbo"},
        {"val": "17", "label": "Iten"},
        {"val": "2", "label": "Mosoriot"},
        {"val": "8", "label": "Webuye"},
        {"val": "84", "label": "Ampath MTRH"},
        {"val": "11", "label": "Kitale"},
        {"val": "19", "label": "Busia"}
        ];

        document.setupAutoComplete('encounter\\.location_id',locationName);


        document.setupAutoCompleteDataForProvider('encounter\\.provider_id_select');

        $('#encounter\\.provider_id_select').change(function () {
            if ($('#encounter\\.provider_id_select').val() === '') {
                $('#encounter\\.provider_id').val('');
                $('.show_provider_id_text').show();
            }
        });

        $('#histopathology_form').validate({});

        var $patientSex = $('#patient\\.sex');
        $patientSex.change(function () {
            var $womenOnly = $('.relevant-female');
            if ($patientSex.val() != 'F') {
                $womenOnly.hide();
                $('body').html("<div class='section text-center'><h4>This form is only applicable to female patient. " +
                        "Please press back to close the form.</h4></div>");
            } else {
                $womenOnly.show();
            }
        });
        $patientSex.trigger('change');

        var showBodyPartSpecificDiagonosis = function (bodyPart) {
            var availableBodyParts = {'8279^CERVIX^99DCT': '#obs\\.pathological_diagnosis_added_cervix',
                '8280^VAGINA^99DCT': '#obs\\.pathological_diagnosis_added_vagina',
                '8281^VULVA^99DCT': '#obs\\.pathological_diagnosis_added_vulva'};

            $.each(availableBodyParts, function (k, v) {
                if (k == bodyPart && k !== '') {
                    $(v).parent().show();
                } else {
                    $(v).val('');
                    $(v).parent().hide();
                }
            })
        };
        var $bodyPart = $('#obs\\.body_part');
        $bodyPart.change(function () {
            showBodyPartSpecificDiagonosis($bodyPart.val());
        });
        $bodyPart.trigger('change');

        var $obs = $('#obs\\.procedures_done_this_visit_detailed');
        $obs.change(function () {
            var procedure = $('#obs\\.procedures_done_this_visit_detailed').val();
            if (procedure === "") {
                $('#obs\\.clock_face_cervical_biopsy_location').parent().hide();
                $('#obs\\.anatomic_location_description').parent().hide();
            } else {
                if ($('#obs\\.procedures_done_this_visit_detailed').val() == "7147^LOOP ELECTROSURGICAL EXCISION PROCEDURE^99DCT") {
                    $('#obs\\.anatomic_location_description').parent().show();
                    $('#obs\\.clock_face_cervical_biopsy_location').parent().hide();
                } else {
                    $('#obs\\.clock_face_cervical_biopsy_location').parent().show();
                    $('#obs\\.anatomic_location_description').parent().hide();
                }
            }
        });
        $obs.trigger('change');


    document.setupValidationForProvider("$('#encounter\\.provider_id_select').val()","encounter\\.provider_id");


    });
</script>

</html>